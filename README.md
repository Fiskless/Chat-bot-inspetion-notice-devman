# Получение уведомлений о проверке работ Devman

Данный скрипт присылает уведомления о проверке работ на [devman](https://dvmn.org/) с помощью, созданного вами Telegram-бота. 
Данный скрипт запущен на сервере [Heroku](https://id.heroku.com/login)

## Запуск

Для запуска скрипта у вас уже должен быть установлен Python 3.

- Скачайте код
- Установите зависимости командой 
    ```sh
    pip install -r requirements.txt
    ```
- Запустите сервер командой 
    ```sh
    python3 main.py
    ```

## Переменные окружения

Часть настроек проекта берётся из переменных окружения. 
Чтобы их определить, создайте файл `.env` рядом с `main.py` 
и запишите туда данные в таком формате: `ПЕРЕМЕННАЯ=значение`.

Используются следующие переменные окружения: 
- `TOKEN_NOTIFICATION_BOT` - токен, созданного вами Telegram-бота для оповещений о проверке работ. Чтобы его получить, необходимо написать Отцу ботов в Telegram(@BotFather). 
Отец ботов попросит ввести два имени. Первое — как он будет отображаться в списке контактов, можно написать на русском. Второе — имя, по которому бота можно будет найти в поиске. Должно быть английском и заканчиваться на bot (например, notification_bot)
- `CHAT_id` - для его получения необходимо написать в Telegram специальному боту: @userinfobot
- `TOKEN_API_DEVMAN` - это ваш персональный токен.  Для его получения зайдите в [API Девмана](https://dvmn.org/api/docs/), ваш токен будет в разделе "Аутентификация".
- `TOKEN_LOGGER_BOT` - токен, созданного вами Telegram-бота, куда будут присылаться сообщения от обработчика логов.


## Функционал бота для оповещения о проверке работ

После окончания проверки работы, он присылает ответ вам в Telegram, при этом информирует о том, какой урок проверен, остались ли там ошибки, а также присылает ссылку на урок. 

## Функционал бота-логгера

Когда запускается бот для проверки оповещений, то бот-логгер присылает оповещение: "Бот запущен". В случае ошибки в боте для проверки оповещений, бот-логгер присылает Traceback ошибки.

## Инструкция по запуску на сервере

- Зарегистрироваться на [Heroku](https://id.heroku.com/login) и создать приложение
- Привязать аккаунт Github к аккаунту Heroku на вкладке Deploy. Потом найдите свой репозиторий с помощью поиска и подключите его к Heroku.
- Отредактировать файл Procfile в репозитории, чтобы он был следующего вида:
  ```sh
      bot: python3 название_файла.py
  ```
- На вкладке Settings вашего приложения в графе Config Vars добавить переменные окружения из вашего ранее созданного .env файла.
- Установите себе консольный клиент [Heroku LCI](https://devcenter.heroku.com/articles/heroku-cli#download-and-install). Он покажет, есть ли какие-либо ошибки, мешающие запуску скрипта на сервере
- На вкладке Deploy вашего приложения в графе Manual Deploy нажмите Deploy Branch. 
- Наслаждайтесь работой скрипта. В случае каких-либо ошибок загляните в Heroku LCI.


## Цели проекта

Код написан в образовательных целях на онлайн-курсе для веб-разработчиков [dvmn.org](https://dvmn.org/).